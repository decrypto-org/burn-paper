\section{Construction}\label{section:construction}

We outline the blockchain address protocol for Bitcoin Pay to Public Key Hash (P2PKH)~\cite{bitcoin-dev-guide} transactions (for completeness, we give a construction which includes the concrete hash functions and checksums of Bitcoin in Appendix~\ref{sec.real}). It is parameterized by a secure signature scheme $S$ and a hash function $H$.
$\GenAddress$ uses $S$ to generate a keypair and hashes the public key in order to generate the public key hash. A tuple consisting of the public key hash and the secret key is returned.
$\SpendVerify$ takes a spending transaction $m$, a scriptSig $\sigma$ and a public key hash $pkh$. The scriptSig should contain the public key $pk$ corresponding to $pkh$ such that $H(pk) = pkh$ and a valid signature for the outpoint $m$, $\sigma'$. If these conditions are met, the function returns true, otherwise it returns false.
The blockchain address protocol is illustrated in Algorithm~\ref{alg.bitcoin}.

\import{./}{algorithms/alg.bitcoin.tex}

Our protocol appears in Algorithm~\ref{alg.construction}.

\import{./}{algorithms/alg.construction.tex}
