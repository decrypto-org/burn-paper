\begin{figure}[t]
\begin{algorithm}[H]
    \caption{\label{alg.bitcoin} The Bitcoin cryptocurrency p2pkh algorithm,
    parameterized by a signature scheme $S = (Gen, Sig, Ver)$.}
    \begin{algorithmic}[1]
        \Function{\textsf{GenAddress}$_{S, H}$}{$1^\lambda$}
            \Let{(pk, sk)}{Gen(1^\lambda)}
            \Let{pkh}{$H_\lambda$(pk)}
            \State\Return{(pkh, sk)}
        \EndFunction
        \Function{\textsf{SpendVerify}$_{S, H}$}{$m, \sigma, pkh$}
            \Let{(pk, \sigma')}{\sigma}
            \If{$H_\lambda(pk) \neq pkh$}
                \State\Return\textsf{false}
            \EndIf
            \State\Return{$Ver(m, \sigma, pk)$}
        \EndFunction
        \vskip8pt
    \end{algorithmic}
\end{algorithm}
\end{figure}
