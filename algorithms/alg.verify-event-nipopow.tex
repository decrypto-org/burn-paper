\begin{algorithm}[H]
    \caption{\label{alg.verify-event-nipopow} A \textsf{verify} implementation which verifies a spend event on the bitcoin blockchain using NIPoPoWs.}
    \begin{algorithmic}[1]
        \Function{$Q_b$}{$S$}
            \State\Return{$b \in S$}
        \EndFunction
        \Function{$\mathsf{verify}_{k,m}^{\mathcal{G},e}$}{$\textsf{(txRaw, txInclusion, blockHeader)}, \mathcal{P}$}
            \If{$\neg \textsf{verify-tx}_e(\textsf{txRaw, txInclusion, blockHeader})$}
                \State\Return{$\false$}
            \EndIf

            \Let{blk}{\textsf{decodeBlockHeader}(\textsf{blockHeader})}
            \State\Return{$\textsf{verify-infix}_{m,k}^{\mathcal{G},Q_\text{blk}}(\mathcal{P})$}
        \EndFunction
        \vskip8pt
    \end{algorithmic}
\end{algorithm}
