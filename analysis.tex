\section{Analysis}

\begin{theorem}[Correctness]
  The Proof-of-Burn protocol $\Pi$ of Section~\ref{section:construction} is \emph{correct}.
\end{theorem}
\begin{proof}
  We need to prove that $\forall \kappa, t. \BurnVerify(1^\kappa, t, \GenBurnAddress(1^\kappa, t)) = \textsf{true}$.

  Based on Algorithm~\ref{alg.construction}, $\BurnVerify(1^\kappa, t, \GenBurnAddress(1^\kappa, t)) = \textsf{true}$ if and only if $\GenBurnAddress(1^\kappa, t) = \GenBurnAddress(1^\kappa, t)$, which always holds as $\GenBurnAddress$ is deterministic.
\end{proof}

\begin{lemma}[Perturbation]
  \label{lem.perturbation}
  Let $p(\kappa)$ be a polynomial and
  $F: \{0,1\}^\kappa \longrightarrow \{0,1\}^\kappa$ be a permutation.
  Consider the process which samples $p(\kappa)$ strings $s_1, s_2, \dots, s_{p(\kappa)}$ uniformly at random from the set $\{0, 1\}^\kappa$. The probability that there exists $i \neq j$ such that $s_i = F(s_j)$ is negligible in $\kappa$.
\end{lemma}
\begin{proof}
  Let \textsc{Match} denote the event that there exist $1 \leq i \neq j \leq p(\kappa)$ such that $s_i = F(s_j)$.
  Let $\textsc{Match}_{i, j}$ denote the event that $s_i = F(s_j)$. Apply a union bound to obtain

  \begin{align*}
    \Pr[\bigcup_{i, j}\textsc{Match}_{i, j}] &\leq \sum_{i, j} \Pr[\textsc{Match}_{i, j}] \\
    \Pr[\textsc{Match}] &\leq \sum_{i, j} \Pr[\textsc{Match}_{i, j}]
  \end{align*}

  But $\Pr[\textsc{Match}_{i, j}] = 2^{-p(\kappa)}$ and therefore
  $\Pr[\textsc{Match}] \leq \sum_{i \neq j} 2^{-p(\kappa)} \leq p^2(\kappa) 2^{-p(\kappa)}$.
\end{proof}

\begin{theorem}[Unspendability]
  If $H$ is a \emph{Random Oracle}, then the protocol $\Pi$ of Section~\ref{section:construction} is \emph{unspendable}.
\end{theorem}
\begin{proof}
  Let $\mathcal{A}$ be an arbitrary probabilistic polynomial time \textsc{spend-attack} adversary.
  The adversary $\mathcal{A}$ makes at most a polynomial number of queries $p(\kappa)$ to the Random Oracle.
  Consider the event \textsc{Match} of Lemma~\ref{lem.perturbation}.

  If the adversary is successful then it has presented $t, pk, pkh$ such that $H(pk) = pkh$ and $H(t) \xor 1 = pkh$.

  We observe that $\textsc{spend-attack}_{\mathcal{A}, \Pi}(\kappa) = \true \Rightarrow \textsc{Match}$.

  Therefore $\Pr[\textsc{spend-attack}_{\mathcal{A}, \Pi}(\kappa)] \leq Pr[\textsc{Match}]$. Applying Lemma~\ref{lem.perturbation} for the permutation $F(x) = x \xor 1$,
  we obtain
  $\Pr[\textsc{spend-attack}_{\mathcal{A}, \Pi}(\kappa)] \leq negl(\kappa)$.
\end{proof}

We note that the security of the signature scheme is not needed to prove unspendability. Were the signature scheme of Bitcoin ever found to be forgeable, the coins burned through our scheme would remain unspendable. We additionally remark that the
choice of the permutation $F(x) = x \xor 1$. Any one-to-one
function beyond the identity function would work equally well.

Our binding theorem only requires that the hash function used is collision
resistant and is in the standard model.

\import{./}{algorithms/alg.collision-resistance-adversary.tex}

\begin{theorem}[Binding]
  If $H$ is a \emph{collision resistant} hash function then the protocol of Section~\ref{section:construction} is \emph{binding}.
\end{theorem}
\begin{proof}
  Let $\mathcal{A}$ be an arbitrary adversary against $\Pi$.
  We will construct the Collision Resistance adversary $\mathcal{A}^*$ against $H$.

  The collision resistance adversary, illustrated in Algorithm~\ref{alg.collision-resistance-adversary}, calls $\mathcal{A}$ and obtains two outputs, $t$ and $t'$. If $\mathcal{A}$ is successful then $t \neq t'$ and $H(t) \xor 1 = H(t') \xor 1$. Therefore $H(t) = H(t')$.

  We thus conclude that $\mathcal{A^*}$ is successful in the \textsf{Collision} game if and only if $\mathcal{A}$ is successful in the \textsf{Bind} game.

  \[
    \Pr[\textsf{Bind}_{\mathcal{A},\Pi} = \true]
    =
    \Pr[\textsf{Collision}_{\mathcal{A}^*,H} = \true]
  \]

  From the collision resistance of $H$ it follows that $\Pr[\textsf{Collision}_{\mathcal{A}^*,H} = 1] < negl(\kappa)$. Therefore,
  $\Pr[\textsf{Bind}_{\mathcal{A},\Pi} = 1] < negl(\kappa)$, so
  the protocol $\Pi$ is binding.
\end{proof}

% TODO: This lemma seems useless... We need to argue about predictability of Gen() by the adversary.
\begin{lemma}[Distinct keys]\label{lem:distinct-keys}
  Let $S = (\Gen, \Sig, \Ver)$ be a secure signature scheme and $p$ be any polynomial. Consider the process which calls $(pk_i, sk_i) \gets \Gen(1^\kappa)$ repeatedly and independently $p(\kappa)$ times to obtain $p(\kappa)$ samples. Then for all $i, j \in [p]$ with $i \neq j$, we have that $pk_i \neq pk_j$, except with negligible probability in $\kappa$.
\end{lemma}
\begin{proof}
  Consider the above process and let \textsc{repeat-key} be the event of two samples $i \neq j$ repeating, i.e., $pk_i = pk_j$. Then consider the following existential forgery adversary $\mathcal{A}$ for the signature scheme $S$. The adversary receives a public key $pk$ and attempts to forge a signature $\sigma$. The adversary calls $(sk', pk') \gets \Gen(1^\kappa)$ to generate a new key $(sk', pk')$. If $pk' \neq pk$, the adversary aborts. Otherwise, the adversary uses $sk'$ to create a signature forgery.

  If $pk = pk'$ then by the correctness of the signature scheme the forgery will be successful. Note that \textsc{repeat-key} is the event of any two keys being repeated among $p$ keys. Additionally, together the forgery challenger $\textsf{Sig-forge}$ and the adversary $\mathcal{A}$ independently generate a pair of keys. Then by applying a union bound we obtain that $p^2 \Pr[\textsf{Sig-forge}^{cma}_{\mathcal{A},S}] \geq \Pr[\textsc{repeat-key}]$. From the fact that $p$ is a polynomial and
  $\Pr[\textsf{Sig-forge}^{cma}_{\mathcal{A},S}]$ is negligible, it follows that $\Pr[\textsc{repeat-key}]$ is negligible.
\end{proof}

Recall that a distribution ensemble is \emph{unpredictable} if no
polynomial-time adversary can guess its output.

\begin{definition}[Unpredictable distribution]
  A distribution ensemble $\{X_{\kappa}\}_{\kappa\in\mathbb{N}}$ is
  \emph{unpredictable} if for all probabilistic polynomial-time adversaries
  $\mathcal{A}$ there exists a negligible function $negl$ such that
  $\Pr[\textsc{predict}_{\mathcal{A},X}(\kappa) = \true] < negl(\kappa)$.
\end{definition}

\import{.}{./algorithms/alg.predict-game.tex}

We now posit that no adversary can predict the public key of a secure signature scheme, except with negligible probability.

\begin{lemma}[Public key unpredictability]\label{lem:pk-unpredictability}
  Let $S = (\textsf{Gen}, \textsf{Sig}, \textsf{Ver})$ be a secure signature scheme.
  Then the distribution $X = \{(sk, pk) \gets \textsf{Gen}; pk\}$ is
  unpredictable.
\end{lemma}
\begin{proof}
  Consider an adversary $\mathcal{A}$ against the \textsc{predict} game and let $q$ denote its probability of success. Then modify the challenger game to invoke $\textsf{Gen}(1^\kappa)$ \emph{twice} independently after the adversary is invoked to obtain $pk'_1$ and $pk'_2$. Consider the event $\textsc{predict-both}$ in which the adversary's guess $pk$ matches the result of both invocations of $\textsf{Gen}$, i.e., $pk'_1 = pk$ and $pk'_2 = pk$.
  Because the invocations of $\textsf{Gen}$ are independent, the probability of the adversary succeeding in guessing \emph{both} invocations of $\textsf{Gen}$ is $q^2$. Therefore
  $
  \Pr[\textsf{predict}_{\mathcal{A},X}(\kappa)]^2 = \Pr[\textsc{predict-both}]
  $.

  Conditioned on the event $\textsc{predict-both}$, we have $pk'_1 = pk'_2$. This is an execution which invokes $\textsf{Gen}$ exactly twice and tries to find non-unique keys in these invocations. Applying Lemma~\ref{lem:distinct-keys} with $p = 2$, we obtain that
  $
  \Pr[\textsc{predict-both}] \leq \textsf{negl}(\kappa)
  $.
  Therefore
  $
  \Pr[\textsf{predict}_{\mathcal{A},X}(\kappa)] \leq \textsf{negl}(\kappa)
  $.
\end{proof}

\import{.}{./algorithms/alg.dist-game.tex}

% TODO: move computational indistinguishability game and definition to appendix
% \begin{definition}[Computational indistinguishability]
% \end{definition}

\begin{theorem}[Uncensorability]
  Let $p$ be a polynomial with $p(\kappa) \in \Omega(\kappa)$, $H$ be a \emph{Random Oracle}, and $S = (\Gen, \Sig, \Ver)$ be a \emph{secure signature scheme}. Consider the tag distribution $\mathcal{T}$ to be the uniform distribution of the set $\{0, 1\}^{p(\kappa)}$.
  Then the protocol of Section~\ref{section:construction} is \emph{uncensorable}.
\end{theorem}
\begin{proof}
  We will argue that both
  $X = \{x: x \gets \textsf{GenAddress}\}$ and
  $Y = \{y: t \gets \mathcal{T}; y \gets \textsf{GenBurnAddress}(1^\kappa, t)\}$ are distributions computationally indistinguishable from the uniform random distribution sampled from $\{0, 1\}^\kappa$. Therefore by transitivity $X$ and $Y$ will be computationally indistinguishable.

  \textbf{Claim 1: $X \cind \{0, 1\}^\kappa$.}
  Let $\mathcal{A}$ be an arbitrary polynomial distinguisher between $X$ and $\{0, 1\}^\kappa$. We will construct an adversary $\mathcal{A}^*$ against $\textsf{pk-predict}$. Let $r(\kappa)$ denote the (polynomial) maximum number of random oracle queries of $\mathcal{A}$. The adversary $\mathcal{A}^*$ works as follows. Initially, it chooses a random bit $b \stackrel{\$}{\gets} \{0, 1\}$ and sets $Z = X$ if $b = 0$, otherwise sets $Z = \{0, 1\}^\kappa$.
  It samples $z \gets Z$. If $b = 0$, then $z$ is chosen by applying \textsf{GenAddress} which involves calling the random oracle $H$ with some input $pk$. It then chooses one of $\mathcal{A}$'s queries $j \stackrel{\$}{\gets} [q]$ at random. Finally, it outputs the input received by the random oracle during the $j^\text{th}$ query of $\mathcal{A}$. Consider the event $\query$ that $b = 0$ and $\mathcal{A}$ asks a random oracle query with input $pk$. Recall the computational indistinguishability game depicted in
  Algorithm~\ref{alg.dist-game} in which the distinguisher gives a guess $b^*$
  attempting to identify the origin $b$ of its input.

  If $b = 0$, then the distinguisher $\mathcal{A}$ receives a truly random input
  $pkh = H(pk)$ which she can only distinguish if she is able to create a query
  to the random oracle with the same $pk$. From
  Lemma~\ref{lem:pk-unpredictability}, the probability that the adversary will
  make the random oracle query $pk$ is negligible, therefore $\Pr[\query] =
  negl(\kappa)$.
  TODO: Talk about what A* and j means.

  Consider the case where the distinguisher does not query the random oracle
  with input $pk$. In that case, the input of the distinguisher is truly random
  and therefore $\Pr[b^* = 0|b = 0|\lnot \query] = \Pr[b^* = 0|b = 1]$.

  Consider the case where $b = 0$ and apply total probability to obtain
  \begin{align*}
  \Pr[b^* = 0|b = 0] &=
    \Pr[b^* = 0|b = 0|\query]\Pr[\query] +
    \Pr[b^* = 0|b = 0|\lnot \query]\Pr[\lnot \query]\\
    &\leq
    \Pr[b^* = 0|b = 0|\query]\Pr[\query] +
    \Pr[b^* = 0|b = 0|\lnot \query]\\
    &\leq
    \Pr[\query] +
    \Pr[b^* = 0|b = 0|\lnot \query]
  \end{align*}

  Consider the probability of success of the distinguisher.

  \[
    \Pr[\textsc{dist-game}_{\mathcal{A},X,U(\{0,1\}^\kappa)} = \true]
    =
    \Pr[b = b^*]
  \]

  Applying total probability we obtain

  \begin{align*}
    \Pr[b = b^*] &= \Pr[b = b^*|b = 0]\Pr[b = 0] + \Pr[b = b^*|b = 1]\Pr[b = 1]\\
                 &= \frac{1}{2}(\Pr[b^* = 0|b = 0]) + \Pr[b^* = 1|b = 1])\\
                 &\leq \frac{1}{2}(\Pr[\query] + \Pr[b^* = 0|b = 0|\lnot \query]
                 + \Pr[b^* = 1|b = 1])\\
                 &= \frac{1}{2}(\Pr[\query] + \Pr[b^* = 0|b = 1]
                 + \Pr[b^* = 1|b = 1])\\
                 &= \frac{1}{2}(\Pr[\query] + \Pr[b^* = 0|b = 1]
                 + (1 - \Pr[b^* = 0|b = 1]))\\
                 &= \frac{1}{2}(1 + \Pr[\query])\\
                 &\leq \frac{1}{2} + negl(\kappa)
  \end{align*}

  % TODO... complete this argument...
  Either $\mathcal{A}$... TODO
  % TODO: Here we need to use Random Oracle programmability to complete the argument formally...

  \textbf{Claim 2: $Y \cind \{0, 1\}^\kappa$.}
  For $Y$, the distinguisher $\mathcal{A}$ receives a truly random input $pkh = H(t)$ where $t$ is sampled from $\mathcal{T}$. From the fact that $p \in \Omega(\kappa)$, the value $t$ is unpredictable to the adversary exept with negligible probability. Therefore the adversary will not make the query $t$ to the random oracle and its input $y$ is indistinguishable from uniformly random.
  % TODO: This argument seems shaky... we need to make it more formal.
\end{proof}
